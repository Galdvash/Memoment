{"ast":null,"code":"import{useContext,useState}from\"react\";import axios from\"axios\";import{toast}from\"react-toastify\";import{UserContext}from\"./userContextApp\";import{useNavigate}from\"react-router-dom\";const useUserApi=()=>{const[isSignIn,setIsSignIn]=useState(false);const[errors,setErrors]=useState({});const[isLoginData,setIsLoginData]=useState({email:\"\",password:\"\"});const[data,setIsData]=useState({name:\"\",email:\"\",password:\"\",isBusiness:false// עבור יוצרי אירועים\n});const{userInformation,setUserInformation}=useContext(UserContext);const navigate=useNavigate();const handleSignInClick=()=>setIsSignIn(false);const handleSignUpClick=()=>setIsSignIn(true);const handleChange=e=>{const{name,value,type,checked}=e.target;const updatedValue=type===\"checkbox\"?checked:value;setIsData(prevData=>({...prevData,[name]:updatedValue}));setIsLoginData(prevData=>({...prevData,[name]:updatedValue}));};const validate=()=>{const newErrors={};if(!data.name||data.name.length<2||data.name.length>256){newErrors.name=\"Name must be between 2 and 256 characters.\";}if(!data.email||data.email.length<5){newErrors.email=\"Email must be at least 5 characters long.\";}if(!data.password||data.password.length<7||data.password.length>20){newErrors.password=\"Password must be between 7 and 20 characters.\";}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(validate()){try{await axios.post(\"http://localhost:5000/api/users/register\",data,{withCredentials:true});toast.success(\"Registration successful!\");// בקשת מידע על המשתמש לאחר הרשמה\nconst userResponse=await axios.get(\"http://localhost:5000/api/users/me\",{withCredentials:true});setUserInformation(userResponse.data);// כאן אנו מעדכנים את userInformation\nsetIsData({name:\"\",email:\"\",password:\"\",isBusiness:false});navigate(\"/packages\");// הפניה לעמוד ה-Packages\n}catch(error){var _error$response,_error$response$data;console.error(error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Registration failed!\");}}else{console.log(\"Validation failed\");}};const handleSubmit2=async e=>{e.preventDefault();try{await axios.post(\"http://localhost:5000/api/users/login\",isLoginData,{withCredentials:true});toast.success(\"Login successful!\");// בקשת מידע על המשתמש לאחר התחברות\nconst userResponse=await axios.get(\"http://localhost:5000/api/users/me\",{withCredentials:true});setUserInformation(userResponse.data);// כאן אנו מעדכנים את userInformation\nsetIsLoginData({email:\"\",password:\"\"});navigate(\"/packages\");// הפניה לעמוד ה-Packages\n}catch(error){var _error$response2,_error$response2$data;console.error(error);toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||\"Login failed!\");}};return{isSignIn,errors,data,isLoginData,userInformation,// ניתן להחזיר את userInformation אם נדרש\nhandleSignInClick,handleSignUpClick,handleChange,handleSubmit,handleSubmit2};};export default useUserApi;","map":{"version":3,"names":["useContext","useState","axios","toast","UserContext","useNavigate","useUserApi","isSignIn","setIsSignIn","errors","setErrors","isLoginData","setIsLoginData","email","password","data","setIsData","name","isBusiness","userInformation","setUserInformation","navigate","handleSignInClick","handleSignUpClick","handleChange","e","value","type","checked","target","updatedValue","prevData","validate","newErrors","length","Object","keys","handleSubmit","preventDefault","post","withCredentials","success","userResponse","get","error","_error$response","_error$response$data","console","response","message","log","handleSubmit2","_error$response2","_error$response2$data"],"sources":["C:/Users/galdv/Desktop/MeMoment/FrontEnd/src/hooks/UserHooks/useUserApi.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\nimport { UserContext } from \"./userContextApp\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst useUserApi = () => {\r\n  const [isSignIn, setIsSignIn] = useState(false);\r\n  const [errors, setErrors] = useState({});\r\n  const [isLoginData, setIsLoginData] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n  const [data, setIsData] = useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    isBusiness: false, // עבור יוצרי אירועים\r\n  });\r\n\r\n  const { userInformation, setUserInformation } = useContext(UserContext);\r\n  const navigate = useNavigate();\r\n\r\n  const handleSignInClick = () => setIsSignIn(false);\r\n  const handleSignUpClick = () => setIsSignIn(true);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    const updatedValue = type === \"checkbox\" ? checked : value;\r\n\r\n    setIsData((prevData) => ({\r\n      ...prevData,\r\n      [name]: updatedValue,\r\n    }));\r\n\r\n    setIsLoginData((prevData) => ({\r\n      ...prevData,\r\n      [name]: updatedValue,\r\n    }));\r\n  };\r\n\r\n  const validate = () => {\r\n    const newErrors = {};\r\n\r\n    if (!data.name || data.name.length < 2 || data.name.length > 256) {\r\n      newErrors.name = \"Name must be between 2 and 256 characters.\";\r\n    }\r\n    if (!data.email || data.email.length < 5) {\r\n      newErrors.email = \"Email must be at least 5 characters long.\";\r\n    }\r\n    if (\r\n      !data.password ||\r\n      data.password.length < 7 ||\r\n      data.password.length > 20\r\n    ) {\r\n      newErrors.password = \"Password must be between 7 and 20 characters.\";\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (validate()) {\r\n      try {\r\n        await axios.post(\"http://localhost:5000/api/users/register\", data, {\r\n          withCredentials: true,\r\n        });\r\n        toast.success(\"Registration successful!\");\r\n\r\n        // בקשת מידע על המשתמש לאחר הרשמה\r\n        const userResponse = await axios.get(\r\n          \"http://localhost:5000/api/users/me\",\r\n          { withCredentials: true }\r\n        );\r\n        setUserInformation(userResponse.data); // כאן אנו מעדכנים את userInformation\r\n\r\n        setIsData({ name: \"\", email: \"\", password: \"\", isBusiness: false });\r\n        navigate(\"/packages\"); // הפניה לעמוד ה-Packages\r\n      } catch (error) {\r\n        console.error(error);\r\n        toast.error(error.response?.data?.message || \"Registration failed!\");\r\n      }\r\n    } else {\r\n      console.log(\"Validation failed\");\r\n    }\r\n  };\r\n\r\n  const handleSubmit2 = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      await axios.post(\"http://localhost:5000/api/users/login\", isLoginData, {\r\n        withCredentials: true,\r\n      });\r\n      toast.success(\"Login successful!\");\r\n\r\n      // בקשת מידע על המשתמש לאחר התחברות\r\n      const userResponse = await axios.get(\r\n        \"http://localhost:5000/api/users/me\",\r\n        { withCredentials: true }\r\n      );\r\n      setUserInformation(userResponse.data); // כאן אנו מעדכנים את userInformation\r\n\r\n      setIsLoginData({ email: \"\", password: \"\" });\r\n      navigate(\"/packages\"); // הפניה לעמוד ה-Packages\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast.error(error.response?.data?.message || \"Login failed!\");\r\n    }\r\n  };\r\n\r\n  return {\r\n    isSignIn,\r\n    errors,\r\n    data,\r\n    isLoginData,\r\n    userInformation, // ניתן להחזיר את userInformation אם נדרש\r\n    handleSignInClick,\r\n    handleSignUpClick,\r\n    handleChange,\r\n    handleSubmit,\r\n    handleSubmit2,\r\n  };\r\n};\r\n\r\nexport default useUserApi;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}